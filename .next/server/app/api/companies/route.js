"use strict";(()=>{var e={};e.id=623,e.ids=[623],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},889:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>m,serverHooks:()=>d,staticGenerationAsyncStorage:()=>u});var a={};t.r(a),t.d(a,{GET:()=>p});var o=t(9303),n=t(8716),s=t(3131),i=t(7070),c=t(3538);async function p(e){try{let{searchParams:r}=new URL(e.url),t=Math.max(1,parseInt(r.get("page")||"1")),a=Math.min(50,Math.max(1,parseInt(r.get("limit")||"50"))),o=r.get("search")||"",n=(t-1)*a;console.log("Query params:",{page:t,limit:a,skip:n,search:o});let s=o?{OR:[{company_name:{contains:o,mode:"insensitive"}},{cin:{contains:o,mode:"insensitive"}}]}:{},[p,m]=await Promise.all([c._.companiesData.findMany({where:s,skip:n,take:a,orderBy:{company_name:"asc"},select:{id:!0,company_name:!0,cin:!0,company_category:!0,company_subcategory:!0,reg_office_address:!0,url_title:!0,company_status:!0,company_state_code:!0,authorized_capital:!0,paidup_capital:!0}}).catch(e=>{throw console.error("Error fetching companies:",e),Error("Failed to fetch companies")}),c._.companiesData.count({where:s}).catch(e=>{throw console.error("Error counting companies:",e),Error("Failed to count companies")})]);if(console.log("Query results:",{totalCompanies:m,fetchedCompanies:p.length,totalPages:Math.ceil(m/a)}),!p)throw Error("No companies data received");return i.NextResponse.json({companies:p,total:m,page:t,totalPages:Math.ceil(m/a),hasMore:n+p.length<m,limit:a})}catch(e){return console.error("Error in companies API:",e),i.NextResponse.json({error:"Internal Server Error",message:e instanceof Error?e.message:"Unknown error occurred"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/companies/route",pathname:"/api/companies",filename:"route",bundlePath:"app/api/companies/route"},resolvedPagePath:"E:\\All Feb Projects 2025\\companies-website-next\\src\\app\\api\\companies\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:u,serverHooks:d}=m,h="/api/companies/route";function g(){return(0,s.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:u})}},3538:(e,r,t)=>{t.d(r,{_:()=>o});var a=t(3524);let o=globalThis.prisma??new a.PrismaClient({log:["query","error","warn"],errorFormat:"pretty"})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,972],()=>t(889));module.exports=a})();